<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>在线表格编辑器</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #333;
            text-align: center;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
        }

        th {
            background-color: #4CAF50;
            color: white;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }

        button:hover {
            background-color: #45a049;
        }

        .export-btn {
            background-color: #2196F3;
        }

        .export-btn:hover {
            background-color: #1976D2;
        }

        /* 新增样式 */
        .header-section {
            text-align: center;
            margin-bottom: 20px;
        }

        .header-title {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }

        .header-subtitle {
            font-size: 16px;
            color: #666;
        }

        .header-badge {
            display: inline-block;
            background-color: #4CAF50;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            margin-left: 10px;
        }

        .footer-note {
            font-size: 14px;
            color: #666;
            margin-top: 20px;
            text-align: center;
        }

        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .preview-table th {
            background-color: #4CAF50;
            color: white;
            padding: 12px;
            text-align: center;
        }

        .preview-table td {
            padding: 12px;
            text-align: center;
            background-color: #f9f9f9;
        }

        .preview-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        /* 隐藏“预览效果”标题 */
        #preview-section h2 {
            display: none;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>尺码推荐表编辑器</h1>

        <div id="editor-section">
            <h2>编辑表格</h2>

            <!-- 标题和说明区域 -->
            <div style="margin-bottom: 20px;">
                <label for="titleInput">表格标题：</label><br>
                <input type="text" id="titleInput" value="尺码推荐表" style="width: 100%; margin-bottom: 10px;">

                <label for="subtitleInput">副标题：</label><br>
                <input type="text" id="subtitleInput" value="罗蒙 ROMON" style="width: 100%; margin-bottom: 10px;">

                <label for="footerInput">底部说明：</label><br>
                <textarea id="footerInput"
                    style="width: 100%; height: 60px;">温馨提示: 因每个人的体型有差异，穿着喜好不同，请结合自身需求选择尺码</textarea>
            </div>

            <div class="table-container">
                <table id="dataTable">
                    <thead>
                        <tr>
                            <th>身高范围</th>
                            <th>体重范围</th>
                            <th>尺码</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><input type="text" value="155-170"></td>
                            <td><input type="text" value="90-100"></td>
                            <td><input type="text" value="28码"></td>
                        </tr>
                        <tr>
                            <td><input type="text" value="170-175"></td>
                            <td><input type="text" value="100-110"></td>
                            <td><input type="text" value="29码"></td>
                        </tr>
                        <tr>
                            <td><input type="text" value="175-180"></td>
                            <td><input type="text" value="110-120"></td>
                            <td><input type="text" value="30码"></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <button onclick="addRow()">添加行</button>
            <button onclick="deleteRow()">删除行</button>
            <button onclick="saveData()">保存数据</button>
            <button class="export-btn" onclick="exportAsImage()">导出为图片</button>
        </div>

        <div id="preview-section"
            style="margin-top: 30px; padding: 20px; background-color: #f9f9f9; border-radius: 8px;">
            <h2>预览效果</h2>
            <div id="preview-content">
                <div class="header-section">
                    <span class="header-title">尺码推荐</span>
                    <span class="header-badge">罗蒙 ROMON</span>
                    <p class="header-subtitle">RECOMMENDED</p>
                </div>
                <table id="preview-table" class="preview-table">
                    <thead>
                        <tr>
                            <th>建议尺码/CM</th>
                            <th>建议体重/斤</th>
                            <th>尺码</th>
                        </tr>
                    </thead>
                    <tbody id="preview-tbody">
                        <tr>
                            <td>155-170</td>
                            <td>90-100</td>
                            <td>28码</td>
                        </tr>
                        <tr>
                            <td>170-175</td>
                            <td>100-110</td>
                            <td>29码</td>
                        </tr>
                        <tr>
                            <td>175-180</td>
                            <td>110-120</td>
                            <td>30码</td>
                        </tr>
                    </tbody>
                </table>
                <p class="footer-note">温馨提示: 因每个人的体型有差异，穿着喜好不同，请结合自身需求选择尺码</p>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/html2canvas/dist/html2canvas.min.js"></script>
    <script>
        // 实时更新预览
        function updatePreview() {
            const title = document.getElementById('titleInput').value || '尺码推荐表';
            const subtitle = document.getElementById('subtitleInput').value || '罗蒙 ROMON';
            const footer = document.getElementById('footerInput').value || '温馨提示: 因每个人的体型有差异，穿着喜好不同，请结合自身需求选择尺码';
            
            document.querySelector('.header-title').textContent = title;
            document.querySelector('.header-subtitle').textContent = subtitle;
            document.querySelector('.footer-note').textContent = footer;
            
            // 获取编辑表格的所有行
            const dataTableRows = document.querySelectorAll('#dataTable tbody tr');
            const previewTbody = document.getElementById('preview-tbody');
            
            // 清空预览表格内容
            previewTbody.innerHTML = '';
            
            // 逐行复制数据
            dataTableRows.forEach((dataRow, index) => {
                const dataCells = dataRow.querySelectorAll('td input');
                const newRow = document.createElement('tr');
                
                // 创建新的预览行
                newRow.innerHTML = `
                    <td>${dataCells[0] ? dataCells[0].value : ''}</td>
                    <td>${dataCells[1] ? dataCells[1].value : ''}</td>
                    <td>${dataCells[2] ? dataCells[2].value : ''}</td>
                `;
                
                previewTbody.appendChild(newRow);
            });
        }

        // 添加新行
        function addRow() {
            const tbody = document.querySelector('#dataTable tbody');
            const newRow = document.createElement('tr');
            
            newRow.innerHTML = `
                <td><input type="text" value=""></td>
                <td><input type="text" value=""></td>
                <td><input type="text" value=""></td>
            `;
            
            tbody.appendChild(newRow);
            updatePreview(); // 更新预览
        }

        // 删除最后一行
        function deleteRow() {
            const tbody = document.querySelector('#dataTable tbody');
            const rows = tbody.getElementsByTagName('tr');
            
            if (rows.length > 1) {
                tbody.removeChild(rows[rows.length - 1]);
                updatePreview(); // 更新预览
            } else {
                alert("至少需要保留一行数据！");
            }
        }

        // 保存数据到浏览器本地存储
        function saveDataToLocalStorage() {
            const data = {
                title: document.getElementById('titleInput').value,
                subtitle: document.getElementById('subtitleInput').value,
                footer: document.getElementById('footerInput').value,
                rows: []
            };
            
            const rows = document.querySelectorAll('#dataTable tbody tr');
            rows.forEach(row => {
                const cells = row.querySelectorAll('td input');
                data.rows.push({
                    height: cells[0].value,
                    weight: cells[1].value,
                    size: cells[2].value
                });
            });
            
            localStorage.setItem('tableData', JSON.stringify(data));
            alert('数据已保存到浏览器！');
        }

        // 保存数据
        function saveData() {
            saveDataToLocalStorage();
        }

        // 从本地存储加载数据
        function loadDataFromLocalStorage() {
            const savedData = localStorage.getItem('tableData');
            if (savedData) {
                const data = JSON.parse(savedData);
                document.getElementById('titleInput').value = data.title || '尺码推荐表';
                document.getElementById('subtitleInput').value = data.subtitle || '罗蒙 ROMON';
                document.getElementById('footerInput').value = data.footer || '温馨提示: 因每个人的体型有差异，穿着喜好不同，请结合自身需求选择尺码';
                
                // 清空现有行
                const tbody = document.querySelector('#dataTable tbody');
                tbody.innerHTML = '';
                
                // 添加保存的行
                data.rows.forEach(rowData => {
                    const newRow = document.createElement('tr');
                    newRow.innerHTML = `
                        <td><input type="text" value="${rowData.height}"></td>
                        <td><input type="text" value="${rowData.weight}"></td>
                        <td><input type="text" value="${rowData.size}"></td>
                    `;
                    tbody.appendChild(newRow);
                });
                
                updatePreview();
                alert('数据已从浏览器加载！');
            } else {
                alert('没有找到保存的数据！');
            }
        }

        // 导出为图片
        function exportAsImage() {
            const previewSection = document.getElementById('preview-section');
            html2canvas(previewSection).then(canvas => {
                const imgDataUrl = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.download = '尺码推荐表.png';
                link.href = imgDataUrl;
                link.click();
            });
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 为输入框添加实时更新监听
            const inputs = document.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                input.addEventListener('input', updatePreview);
            });
            
            // 页面加载时尝试加载数据
            loadDataFromLocalStorage();
        });
    </script>
</body>

</html>