<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>在线表格编辑器</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background-color: #4CAF50;
            color: white;
            padding: 20px;
            text-align: center;
        }

        .content-wrapper {
            display: flex;
            flex-wrap: wrap;
        }

        .editor-section {
            flex: 1;
            min-width: 300px;
            padding: 20px;
            border-right: 1px solid #eee;
        }

        .preview-section {
            flex: 1;
            min-width: 300px;
            padding: 20px;
        }

        .section-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 5px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 60px;
        }

        .controls-group {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        .control-row {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .control-row label {
            width: 120px;
            margin-right: 10px;
            white-space: nowrap;
        }

        .control-row input[type="number"],
        .control-row input[type="color"] {
            margin-right: 10px;
        }

        .buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }

        .btn-primary {
            background-color: #4CAF50;
            color: white;
        }

        .btn-primary:hover {
            background-color: #45a049;
        }

        .btn-info {
            background-color: #2196F3;
            color: white;
        }

        .btn-info:hover {
            background-color: #1976D2;
        }

        .preview-content {
            border: 1px solid #ddd;
            padding: 20px;
            background-color: white;
            border-radius: 5px;
            width: 100%;
            height: 500px; /* 扩大预览区域 */
            overflow-y: auto; /* 添加滚动条 */
        }

        .preview-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .preview-title {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .preview-subtitle {
            font-size: 16px;
            color: #666;
            margin-bottom: 10px;
        }

        .preview-badge {
            display: inline-block;
            background-color: #4CAF50;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            margin-left: 10px;
            font-size: 14px;
        }

        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .preview-table th {
            background-color: #4CAF50;
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: bold;
        }

        .preview-table td {
            padding: 12px;
            text-align: center;
        }

        .preview-footer {
            font-size: 14px;
            color: #666;
            margin-top: 20px;
            text-align: center;
        }

        .resizer {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            width: 5px;
            background: #ccc;
            cursor: col-resize;
            user-select: none;
            z-index: 10;
        }

        .resizer:hover {
            background: #999;
        }

        @media (max-width: 768px) {
            .content-wrapper {
                flex-direction: column;
            }
            
            .editor-section {
                border-right: none;
                border-bottom: 1px solid #eee;
            }
        }

        /* 样式优化 */
        .preview-table {
            table-layout: fixed; /* 确保列宽均匀分布 */
        }

        .preview-table th,
        .preview-table td {
            width: calc(33.33%); /* 确保三列宽度相等 */
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>在线表格编辑器</h1>
        </div>

        <div class="content-wrapper">
            <!-- 编辑区域 -->
            <div class="editor-section">
                <div class="section-title">基础信息设置</div>
                
                <div class="form-group">
                    <label for="titleInput">表格标题：</label>
                    <input type="text" id="titleInput" value="尺码推荐表">
                </div>

                <div class="form-group">
                    <label for="subtitleInput">副标题：</label>
                    <input type="text" id="subtitleInput" value="英杰外贸服饰">
                </div>

                <div class="form-group">
                    <label for="footerInput">底部说明：</label>
                    <textarea id="footerInput">温馨提示: 因每个人的体型有差异，穿着喜好不同，请结合自身需求选择尺码</textarea>
                </div>

                <div class="section-title">字体设置</div>
                <div class="controls-group">
                    <div class="control-row">
                        <label>标题字体大小：</label>
                        <input type="number" id="titleFontSize" min="10" max="50" value="24" onchange="updatePreview()">
                        <label>标题颜色：</label>
                        <input type="color" id="titleColor" value="#333333" onchange="updatePreview()">
                    </div>
                    
                    <div class="control-row">
                        <label>副标题字体大小：</label>
                        <input type="number" id="subtitleFontSize" min="10" max="50" value="16" onchange="updatePreview()">
                        <label>副标题颜色：</label>
                        <input type="color" id="subtitleColor" value="#666666" onchange="updatePreview()">
                    </div>
                    
                    <div class="control-row">
                        <label>表头字体大小：</label>
                        <input type="number" id="headerFontSize" min="10" max="50" value="16" onchange="updatePreview()">
                        <label>表头颜色：</label>
                        <input type="color" id="headerColor" value="#ffffff" onchange="updatePreview()">
                    </div>
                    
                    <div class="control-row">
                        <label>数据字体大小：</label>
                        <input type="number" id="dataFontSize" min="10" max="50" value="14" onchange="updatePreview()">
                        <label>数据颜色：</label>
                        <input type="color" id="dataColor" value="#333333" onchange="updatePreview()">
                    </div>
                    
                    <div class="control-row">
                        <label>底部说明字体大小：</label>
                        <input type="number" id="footerFontSize" min="10" max="50" value="14" onchange="updatePreview()">
                        <label>底部说明颜色：</label>
                        <input type="color" id="footerColor" value="#666666" onchange="updatePreview()">
                    </div>
                </div>

                <div class="section-title">底色设置</div>
                <div class="controls-group">
                    <div class="control-row">
                        <label>副标题背景颜色：</label>
                        <input type="color" id="subtitleBgColor" value="#ffffff" onchange="updatePreview()">
                    </div>
                    
                    <div class="control-row">
                        <label>商标背景颜色：</label>
                        <input type="color" id="badgeBgColor" value="#4CAF50" onchange="updatePreview()">
                    </div>
                    
                    <div class="control-row">
                        <label>奇数行背景颜色：</label>
                        <input type="color" id="oddRowBgColor" value="#f9f9f9" onchange="updatePreview()">
                        <label>偶数行背景颜色：</label>
                        <input type="color" id="evenRowBgColor" value="#f2f2f2" onchange="updatePreview()">
                    </div>
                </div>

                <div class="section-title">表格数据</div>
                <div class="table-container">
                    <table id="dataTable">
                        <thead>
                            <tr>
                                <th>身高范围</th>
                                <th>体重范围</th>
                                <th>尺码</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input type="text" value="155-170"></td>
                                <td><input type="text" value="90-100"></td>
                                <td><input type="text" value="28码"></td>
                            </tr>
                            <tr>
                                <td><input type="text" value="170-175"></td>
                                <td><input type="text" value="100-110"></td>
                                <td><input type="text" value="29码"></td>
                            </tr>
                            <tr>
                                <td><input type="text" value="175-180"></td>
                                <td><input type="text" value="110-120"></td>
                                <td><input type="text" value="30码"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="buttons">
                    <button class="btn btn-primary" onclick="addRow()">添加行</button>
                    <button class="btn btn-primary" onclick="deleteRow()">删除行</button>
                    <button class="btn btn-primary" onclick="saveData()">保存数据</button>
                    <button class="btn btn-info" onclick="exportAsImage()">导出为图片</button>
                </div>
            </div>

            <!-- 预览区域 -->
            <div class="preview-section">
                <div class="section-title">预览效果</div>
                <div class="preview-content" id="preview-content">
                    <div class="preview-header">
                        <span class="preview-title">尺码推荐</span>
                        <span class="preview-badge">英杰外贸服饰</span>
                        <p class="preview-subtitle">RECOMMENDED</p>
                    </div>
                    <table id="preview-table" class="preview-table">
                        <thead>
                            <tr>
                                <th>建议尺码/CM</th>
                                <th>建议体重/斤</th>
                                <th>尺码</th>
                            </tr>
                        </thead>
                        <tbody id="preview-tbody">
                            <tr>
                                <td>155-170</td>
                                <td>90-100</td>
                                <td>28码</td>
                            </tr>
                            <tr>
                                <td>170-175</td>
                                <td>100-110</td>
                                <td>29码</td>
                            </tr>
                            <tr>
                                <td>175-180</td>
                                <td>110-120</td>
                                <td>30码</td>
                            </tr>
                        </tbody>
                    </table>
                    <p class="preview-footer">温馨提示: 因每个人的体型有差异，穿着喜好不同，请结合自身需求选择尺码</p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/html2canvas/dist/html2canvas.min.js"></script>
    <script>
        // 实时更新预览
        function updatePreview() {
            const title = document.getElementById('titleInput').value || '尺码推荐表';
            const subtitle = document.getElementById('subtitleInput').value || '英杰外贸服饰';
            const footer = document.getElementById('footerInput').value || '温馨提示: 因每个人的体型有差异，穿着喜好不同，请结合自身需求选择尺码';
            
            // 更新标题
            document.querySelector('.preview-title').textContent = title;
            
            // 更新副标题
            document.querySelector('.preview-subtitle').textContent = subtitle;
            
            // 更新底部说明
            document.querySelector('.preview-footer').textContent = footer;
            
            // 获取编辑表格的所有行
            const dataTableRows = document.querySelectorAll('#dataTable tbody tr');
            const previewTbody = document.getElementById('preview-tbody');
            
            // 清空预览表格内容
            previewTbody.innerHTML = '';
            
            // 逐行复制数据
            dataTableRows.forEach((dataRow, index) => {
                const dataCells = dataRow.querySelectorAll('td input');
                const newRow = document.createElement('tr');
                
                // 创建新的预览行
                newRow.innerHTML = `
                    <td>${dataCells[0] ? dataCells[0].value : ''}</td>
                    <td>${dataCells[1] ? dataCells[1].value : ''}</td>
                    <td>${dataCells[2] ? dataCells[2].value : ''}</td>
                `;
                
                previewTbody.appendChild(newRow);
            });
            
            // 应用字体设置
            applyFontSettings();
            
            // 应用底色设置
            applyColorSettings();
        }

        // 应用字体设置
        function applyFontSettings() {
            const titleSize = document.getElementById('titleFontSize').value;
            const titleColor = document.getElementById('titleColor').value;
            document.querySelector('.preview-title').style.fontSize = titleSize + 'px';
            document.querySelector('.preview-title').style.color = titleColor;
            
            const subtitleSize = document.getElementById('subtitleFontSize').value;
            const subtitleColor = document.getElementById('subtitleColor').value;
            document.querySelector('.preview-subtitle').style.fontSize = subtitleSize + 'px';
            document.querySelector('.preview-subtitle').style.color = subtitleColor;
            
            const headerSize = document.getElementById('headerFontSize').value;
            const headerColor = document.getElementById('headerColor').value;
            const headers = document.querySelectorAll('.preview-table th');
            headers.forEach(header => {
                header.style.fontSize = headerSize + 'px';
                header.style.color = headerColor;
            });
            
            const dataSize = document.getElementById('dataFontSize').value;
            const dataColor = document.getElementById('dataColor').value;
            const cells = document.querySelectorAll('.preview-table td');
            cells.forEach(cell => {
                cell.style.fontSize = dataSize + 'px';
                cell.style.color = dataColor;
            });
            
            const footerSize = document.getElementById('footerFontSize').value;
            const footerColor = document.getElementById('footerColor').value;
            document.querySelector('.preview-footer').style.fontSize = footerSize + 'px';
            document.querySelector('.preview-footer').style.color = footerColor;
        }

        // 应用底色设置
        function applyColorSettings() {
            const subtitleBgColor = document.getElementById('subtitleBgColor').value;
            document.querySelector('.preview-subtitle').style.backgroundColor = subtitleBgColor;
            
            const badgeBgColor = document.getElementById('badgeBgColor').value;
            document.querySelector('.preview-badge').style.backgroundColor = badgeBgColor;
            
            const oddRowBgColor = document.getElementById('oddRowBgColor').value;
            const evenRowBgColor = document.getElementById('evenRowBgColor').value;
            
            const rows = document.querySelectorAll('.preview-table tbody tr');
            rows.forEach((row, index) => {
                if (index % 2 === 0) {
                    row.style.backgroundColor = oddRowBgColor;
                } else {
                    row.style.backgroundColor = evenRowBgColor;
                }
            });
        }

        // 添加新行
        function addRow() {
            const tbody = document.querySelector('#dataTable tbody');
            const newRow = document.createElement('tr');
            
            newRow.innerHTML = `
                <td><input type="text" value=""></td>
                <td><input type="text" value=""></td>
                <td><input type="text" value=""></td>
            `;
            
            tbody.appendChild(newRow);
            updatePreview(); // 更新预览
        }

        // 删除最后一行
        function deleteRow() {
            const tbody = document.querySelector('#dataTable tbody');
            const rows = tbody.getElementsByTagName('tr');
            
            if (rows.length > 1) {
                tbody.removeChild(rows[rows.length - 1]);
                updatePreview(); // 更新预览
            } else {
                alert("至少需要保留一行数据！");
            }
        }

        // 保存数据到浏览器本地存储
        function saveDataToLocalStorage() {
            const data = {
                title: document.getElementById('titleInput').value,
                subtitle: document.getElementById('subtitleInput').value,
                footer: document.getElementById('footerInput').value,
                rows: []
            };
            
            const rows = document.querySelectorAll('#dataTable tbody tr');
            rows.forEach(row => {
                const cells = row.querySelectorAll('td input');
                data.rows.push({
                    height: cells[0].value,
                    weight: cells[1].value,
                    size: cells[2].value
                });
            });
            
            localStorage.setItem('tableData', JSON.stringify(data));
            alert('数据已保存到浏览器！');
        }

        // 保存数据
        function saveData() {
            saveDataToLocalStorage();
            updatePreview(); // 保存后同步更新预览
        }

        // 从本地存储加载数据
        function loadDataFromLocalStorage() {
            const savedData = localStorage.getItem('tableData');
            if (savedData) {
                const data = JSON.parse(savedData);
                document.getElementById('titleInput').value = data.title || '尺码推荐表';
                document.getElementById('subtitleInput').value = data.subtitle || '英杰外贸服饰';
                document.getElementById('footerInput').value = data.footer || '温馨提示: 因每个人的体型有差异，穿着喜好不同，请结合自身需求选择尺码';
                
                // 清空现有行
                const tbody = document.querySelector('#dataTable tbody');
                tbody.innerHTML = '';
                
                // 添加保存的行
                data.rows.forEach(rowData => {
                    const newRow = document.createElement('tr');
                    newRow.innerHTML = `
                        <td><input type="text" value="${rowData.height}"></td>
                        <td><input type="text" value="${rowData.weight}"></td>
                        <td><input type="text" value="${rowData.size}"></td>
                    `;
                    tbody.appendChild(newRow);
                });
                
                updatePreview();
                alert('数据已从浏览器加载！');
            } else {
                alert('没有找到保存的数据！');
            }
        }

        // 导出为图片
        function exportAsImage() {
            const previewSection = document.getElementById('preview-content');
            html2canvas(previewSection).then(canvas => {
                const imgDataUrl = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.download = '尺码推荐表.png';
                link.href = imgDataUrl;
                link.click();
            });
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function () {
            // 页面加载时尝试加载数据
            loadDataFromLocalStorage();
            
            // 初始化预览
            updatePreview();
        });
    </script>
</body>

</html>